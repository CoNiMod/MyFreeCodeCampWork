# 线性回归健康成本计算器

## 项目概述

这是一个基于深度学习的线性回归项目，用于预测医疗保健费用。项目使用TensorFlow/Keras构建神经网络模型，通过分析患者的年龄、性别、BMI、子女数量、吸烟状态和地区等特征来预测医疗费用。

## 项目要求

- 使用回归算法预测医疗费用
- 将分类数据转换为数字
- 80%数据用于训练，20%用于测试
- 平均绝对误差(MAE)必须低于3500美元
- 使用测试集验证模型的泛化能力

## 数据集

项目使用Book-Crossings数据集，包含以下特征：
- **age**: 年龄
- **sex**: 性别 (male/female)
- **bmi**: 身体质量指数
- **children**: 子女数量
- **smoker**: 吸烟状态 (yes/no)
- **region**: 地区
- **expenses**: 医疗费用 (目标变量)

## 技术实现

### 1. 数据预处理
- **分类编码**: 将性别、吸烟状态、地区等分类变量转换为数字编码
- **数据划分**: 使用sklearn的train_test_split进行80/20划分
- **特征标准化**: 使用StandardScaler对数值特征进行标准化

### 2. 模型架构
```python
model = keras.Sequential([
    layers.Dense(64, activation='relu', input_shape=[6]),  # 输入层
    layers.Dropout(0.2),                                  # 防止过拟合
    layers.Dense(32, activation='relu'),                  # 隐藏层1
    layers.Dropout(0.2),                                  # 防止过拟合
    layers.Dense(16, activation='relu'),                  # 隐藏层2
    layers.Dense(1)                                       # 输出层
])
```

### 3. 训练配置
- **优化器**: Adam
- **损失函数**: 均方误差(MSE)
- **评估指标**: 平均绝对误差(MAE)和均方误差(MSE)
- **训练轮数**: 100 epochs
- **验证分割**: 20%用于验证

## 使用方法

### 在Google Colab中运行
1. 打开Jupyter notebook文件
2. 运行所有代码单元格
3. 等待模型训练完成
4. 查看测试结果和可视化图表

### 本地运行
```bash
# 安装依赖
pip install tensorflow pandas numpy matplotlib scikit-learn

# 运行Python脚本
python fcc_predict_health_costs_with_regression.py
```

## 项目文件

- `fcc_predict_health_costs_with_regression.py`: 完整的Python脚本
- `README.md`: 项目说明文档

## 预期结果

成功完成项目后，你将看到：
1. **训练过程**: 显示每个epoch的训练和验证指标
2. **训练历史图表**: 展示MAE和损失的变化趋势
3. **测试结果**: 显示测试集的平均绝对误差
4. **预测对比图**: 真实值vs预测值的散点图
5. **特征重要性**: 分析各个特征对预测的影响程度

## 成功标准

项目通过以下测试后视为成功：
- 测试集平均绝对误差 < 3500美元
- 显示"You passed the challenge. Great job!"消息
- 模型能够有效泛化到未见过的数据

## 技术亮点

1. **深度神经网络**: 使用多层感知机进行非线性回归
2. **正则化技术**: Dropout层防止过拟合
3. **数据标准化**: 提高模型训练稳定性和收敛速度
4. **可视化分析**: 全面的训练过程和数据分布可视化
5. **特征工程**: 智能处理分类和数值特征

## 学习收获

通过完成这个项目，你将掌握：
- 深度学习回归模型的构建和训练
- 数据预处理和特征工程技巧
- 模型评估和可视化方法
- 医疗数据分析的实际应用

## 注意事项

- 确保有足够的计算资源（推荐使用GPU）
- 数据下载可能需要网络连接
- 模型训练时间取决于硬件配置
- 随机种子固定以确保结果可重现

## 未来改进方向

1. **模型优化**: 尝试不同的网络架构和超参数
2. **特征选择**: 分析特征重要性，移除无关特征
3. **集成学习**: 结合多个模型提高预测准确性
4. **实时预测**: 开发Web API供实际应用使用
5. **模型解释**: 使用SHAP等工具解释模型决策过程
